{"ast":null,"code":"import { resolveComponent as _resolveComponent, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, createElementBlock as _createElementBlock } from \"vue\";\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_SearchPublications = _resolveComponent(\"SearchPublications\");\n\n  const _component_AddPublication = _resolveComponent(\"AddPublication\");\n\n  const _component_PublicationItem = _resolveComponent(\"PublicationItem\");\n\n  return _openBlock(), _createElementBlock(\"div\", null, [!$data.publishMode ? (_openBlock(), _createBlock(_component_SearchPublications, {\n    key: 0,\n    onSearchPublications: $options.searchPublications,\n    onTogglePublish: _cache[0] || (_cache[0] = $event => $data.publishMode = true),\n    resultats: this.resultats\n  }, null, 8\n  /* PROPS */\n  , [\"onSearchPublications\", \"resultats\"])) : _createCommentVNode(\"v-if\", true), $data.publishMode ? (_openBlock(), _createBlock(_component_AddPublication, {\n    key: 1,\n    onAddPublication: $options.addPublication,\n    onTogglePublish: _cache[1] || (_cache[1] = $event => $data.publishMode = false)\n  }, null, 8\n  /* PROPS */\n  , [\"onAddPublication\"])) : _createCommentVNode(\"v-if\", true), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.publications, publication => {\n    return _openBlock(), _createBlock(_component_PublicationItem, {\n      publication: publication,\n      key: publication._id,\n      onDeletePublication: $event => $options.deletePublication(publication._id),\n      onEditPublication: $options.editPublication\n    }, null, 8\n    /* PROPS */\n    , [\"publication\", \"onDeletePublication\", \"onEditPublication\"]);\n  }), 128\n  /* KEYED_FRAGMENT */\n  ))]);\n}","map":{"version":3,"mappings":";;;;;;;;uBACCA,oBAmBM,KAnBN,EAmBM,IAnBN,EAmBM,EAjBGC,mCADRC,aAKEC,6BALF,EAKE;UAAA;AAHAC,wBAAkB,EAAEC,2BAGpB;AAFAC,mBAAa,sCAAEL,oBAAW,IAAb,CAEb;AADAM,aAAS,OAAOA;AAChB,GALF;;AAAA,+EAkBK,EAXEN,mCADPC,aAIEM,yBAJF,EAIE;UAAA;AAFAC,oBAAc,EAAEJ,uBAEhB;AADAC,mBAAa,sCAAEL,oBAAW,KAAb;AACb,GAJF;;AAAA,8DAYK,qBAPLD,oBAMmBU,SANnB,EAMmB,IANnB,EAMmBC,YALIV,kBAKJ,EALXW,WAA2B,IAAhB;yBADnBV,aAMmBW,0BANnB,EAMmB;AAJjBD,iBAAW,EAAEA,WAII;AAHjBE,SAAG,EAAEF,WAAW,CAACG,GAGA;AAFjBC,yBAAiB,YAAEX,2BAAkBO,WAAW,CAACG,GAA9B,CAEF;AADjBE,uBAAe,EAAEZ;AACA,KANnB;;AAAA;GAMmB,CANnB;;AAAA,GAOK,EAnBN","names":["_createElementBlock","$data","_createBlock","_component_SearchPublications","onSearchPublications","$options","onTogglePublish","resultats","_component_AddPublication","onAddPublication","_Fragment","_renderList","publication","_component_PublicationItem","key","_id","onDeletePublication","onEditPublication"],"sourceRoot":"","sources":["C:\\Users\\yveno\\Desktop\\projet-posts - vue frontend\\front\\src\\components\\PublicationsList.vue"],"sourcesContent":["<template>\r\n\t<div>\r\n\t\t<SearchPublications\r\n\t\t\tv-if=\"!publishMode\"\r\n\t\t\t@searchPublications=\"searchPublications\"\r\n\t\t\t@togglePublish=\"publishMode = true\"\r\n\t\t\t:resultats=\"this.resultats\"\r\n\t\t/>\r\n\t\t<AddPublication\r\n\t\t\tv-if=\"publishMode\"\r\n\t\t\t@addPublication=\"addPublication\"\r\n\t\t\t@togglePublish=\"publishMode = false\"\r\n\t\t/>\r\n\t\t<PublicationItem\r\n\t\t\tv-for=\"publication in publications\"\r\n\t\t\t:publication=\"publication\"\r\n\t\t\t:key=\"publication._id\"\r\n\t\t\t@deletePublication=\"deletePublication(publication._id)\"\r\n\t\t\t@editPublication=\"editPublication\"\r\n\t\t></PublicationItem>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\n\timport PublicationItem from \"./PublicationItem.vue\";\r\n\timport AddPublication from \"./AddPublication.vue\";\r\n\timport SearchPublications from \"./SearchPublications.vue\";\r\n\texport default {\r\n\t\tname: \"PublicationsList\",\r\n\t\tcomponents: {\r\n\t\t\tAddPublication,\r\n\t\t\tSearchPublications,\r\n\t\t\tPublicationItem,\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tpublications: {},\r\n\t\t\t\tpublishMode: false,\r\n\t\t\t\tresultats: 0,\r\n\t\t\t};\r\n\t\t},\r\n\t\tbeforeMount() {\r\n\t\t\tthis.getPublications();\r\n\t\t},\r\n\t\tmounted() {\r\n\t\t\tconst socket = new WebSocket(\"ws://localhost:5000\");\r\n\r\n\t\t\t// Connection opened\r\n\t\t\tsocket.addEventListener(\"open\", () => {\r\n\t\t\t\tconsole.log(\"connected to the ws server\");\r\n\t\t\t});\r\n\r\n\t\t\t// Listen for messages\r\n\t\t\tsocket.addEventListener(\"message\", (event) => {\r\n\t\t\t\tconsole.log(\"Message from server \", event);\r\n\t\t\t});\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tgetPublications() {\r\n\t\t\t\tfetch(\"http://localhost:5000/api/publications\")\r\n\t\t\t\t\t.then((res) => res.json())\r\n\t\t\t\t\t.then((publications) => {\r\n\t\t\t\t\t\tthis.publications = publications.data.reverse();\r\n\t\t\t\t\t\tthis.resultats = publications.data.length;\r\n\t\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\tsearchPublications(search) {\r\n\t\t\t\tfetch(\r\n\t\t\t\t\t`http://localhost:5000/api/publications/query?search=${search}`\r\n\t\t\t\t)\r\n\t\t\t\t\t.then((res) => res.json())\r\n\t\t\t\t\t.then((publications) => {\r\n\t\t\t\t\t\tif (!publications.success) {\r\n\t\t\t\t\t\t\tconsole.log(publications);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.publications = publications.data.reverse();\r\n\t\t\t\t\t\t\tthis.resultats = publications.data.length;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\taddPublication(postBody) {\r\n\t\t\t\tconst options = {\r\n\t\t\t\t\tmethod: \"POST\",\r\n\t\t\t\t\theaders: {\r\n\t\t\t\t\t\tAccept: \"application/json\",\r\n\t\t\t\t\t\t\"Content-Type\": \"application/json;charset=UTF-8\",\r\n\t\t\t\t\t},\r\n\t\t\t\t\tbody: JSON.stringify({\r\n\t\t\t\t\t\tcontent: postBody,\r\n\t\t\t\t\t}),\r\n\t\t\t\t};\r\n\t\t\t\tfetch(\"http://localhost:5000/api/publications\", options)\r\n\t\t\t\t\t.then((res) => res.json())\r\n\t\t\t\t\t.then((res) => {\r\n\t\t\t\t\t\tif (!res.success) {\r\n\t\t\t\t\t\t\tconsole.log(res.msg);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.getPublications();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch((error) => console.log(error));\r\n\t\t\t},\r\n\r\n\t\t\teditPublication(id, postBody) {\r\n\t\t\t\tconst options = {\r\n\t\t\t\t\tmethod: \"PATCH\",\r\n\t\t\t\t\theaders: {\r\n\t\t\t\t\t\tAccept: \"application/json\",\r\n\t\t\t\t\t\t\"Content-Type\": \"application/json;charset=UTF-8\",\r\n\t\t\t\t\t},\r\n\t\t\t\t\tbody: JSON.stringify({\r\n\t\t\t\t\t\tcontent: postBody,\r\n\t\t\t\t\t}),\r\n\t\t\t\t};\r\n\t\t\t\tfetch(`http://localhost:5000/api/publications/${id}`, options)\r\n\t\t\t\t\t.then((res) => res.json())\r\n\t\t\t\t\t.then((res) => {\r\n\t\t\t\t\t\tif (!res.success) {\r\n\t\t\t\t\t\t\tconsole.log(res.msg);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.getPublications();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch((error) => console.log(error));\r\n\t\t\t},\r\n\r\n\t\t\tdeletePublication(id) {\r\n\t\t\t\tconst options = {\r\n\t\t\t\t\tmethod: \"DELETE\",\r\n\t\t\t\t\theaders: {\r\n\t\t\t\t\t\tAccept: \"application/json\",\r\n\t\t\t\t\t\t\"Content-Type\": \"application/json;charset=UTF-8\",\r\n\t\t\t\t\t},\r\n\t\t\t\t};\r\n\t\t\t\tfetch(`http://localhost:5000/api/publications/${id}`, options)\r\n\t\t\t\t\t.then((res) => res.json())\r\n\t\t\t\t\t.then((res) => {\r\n\t\t\t\t\t\tif (!res.success) {\r\n\t\t\t\t\t\t\tconsole.log(res.msg);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.getPublications();\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch((error) => console.log(error));\r\n\t\t\t},\r\n\t\t},\r\n\t};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped></style>\r\n"]},"metadata":{},"sourceType":"module"}