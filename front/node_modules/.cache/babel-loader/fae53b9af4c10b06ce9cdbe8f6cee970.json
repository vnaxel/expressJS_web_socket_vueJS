{"ast":null,"code":"import PublicationItem from \"./PublicationItem.vue\";\nimport AddPublication from \"./AddPublication.vue\";\nimport SearchPublications from \"./SearchPublications.vue\";\nexport default {\n  name: \"PublicationsList\",\n  components: {\n    AddPublication,\n    SearchPublications,\n    PublicationItem\n  },\n\n  data() {\n    return {\n      publications: {},\n      publishMode: false,\n      resultats: 0,\n      search: ''\n    };\n  },\n\n  beforeMount() {\n    this.getPublications();\n  },\n\n  mounted() {\n    const socket = new WebSocket(\"ws://localhost:5000\"); // Connection opened\n\n    socket.addEventListener(\"open\", () => {\n      console.log(\"connected to the ws server\");\n    }); // Listen for messages\n\n    socket.addEventListener(\"message\", () => {\n      if (this.publishMode) {\n        this.getPublications();\n      } else {\n        this.searchPublications(this.search);\n      }\n    });\n  },\n\n  methods: {\n    getPublications() {\n      fetch(\"http://localhost:5000/api/publications\").then(res => res.json()).then(publications => {\n        this.publications = publications.data.reverse();\n        this.resultats = publications.data.length;\n      });\n    },\n\n    lastSearch(search) {\n      this.search = search;\n    },\n\n    searchPublications(search) {\n      fetch(`http://localhost:5000/api/publications/query?search=${search}`).then(res => res.json()).then(publications => {\n        if (!publications.success) {\n          console.log(publications);\n        } else {\n          this.publications = publications.data.reverse();\n          this.resultats = publications.data.length;\n        }\n      });\n    },\n\n    addPublication(postBody) {\n      const options = {\n        method: \"POST\",\n        headers: {\n          Accept: \"application/json\",\n          \"Content-Type\": \"application/json;charset=UTF-8\"\n        },\n        body: JSON.stringify({\n          content: postBody\n        })\n      };\n      fetch(\"http://localhost:5000/api/publications\", options).then(res => res.json()).then(res => {\n        if (!res.success) {\n          console.log(res.msg);\n        } else {\n          this.getPublications();\n        }\n      }).catch(error => console.log(error));\n    },\n\n    editPublication(id, postBody) {\n      const options = {\n        method: \"PATCH\",\n        headers: {\n          Accept: \"application/json\",\n          \"Content-Type\": \"application/json;charset=UTF-8\"\n        },\n        body: JSON.stringify({\n          content: postBody\n        })\n      };\n      fetch(`http://localhost:5000/api/publications/${id}`, options).then(res => res.json()).then(res => {\n        if (!res.success) {\n          console.log(res.msg);\n        } else {\n          this.getPublications();\n        }\n      }).catch(error => console.log(error));\n    },\n\n    deletePublication(id) {\n      const options = {\n        method: \"DELETE\",\n        headers: {\n          Accept: \"application/json\",\n          \"Content-Type\": \"application/json;charset=UTF-8\"\n        }\n      };\n      fetch(`http://localhost:5000/api/publications/${id}`, options).then(res => res.json()).then(res => {\n        if (!res.success) {\n          console.log(res.msg);\n        }\n\n        this.getPublications();\n      }).catch(error => console.log(error));\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["PublicationItem","AddPublication","SearchPublications","name","components","data","publications","publishMode","resultats","search","beforeMount","getPublications","mounted","socket","WebSocket","addEventListener","console","log","searchPublications","methods","fetch","then","res","json","reverse","length","lastSearch","success","addPublication","postBody","options","method","headers","Accept","body","JSON","stringify","content","msg","catch","error","editPublication","id","deletePublication"],"sourceRoot":"","sources":["C:\\Users\\yveno\\Desktop\\projet-posts - vue frontend\\front\\src\\components\\PublicationsList.vue"],"sourcesContent":["<template>\r\n\t<div>\r\n\t\t<SearchPublications\r\n\t\t\tv-if=\"!publishMode\"\r\n\t\t\t@searchPublications=\"searchPublications\"\r\n\t\t\t@lastSearch=\"lastSearch\"\r\n\t\t\t@togglePublish=\"publishMode = true\"\r\n\t\t\t:resultats=\"this.resultats\"\r\n\t\t/>\r\n\t\t<AddPublication\r\n\t\t\tv-if=\"publishMode\"\r\n\t\t\t@addPublication=\"addPublication\"\r\n\t\t\t@togglePublish=\"publishMode = false\"\r\n\t\t/>\r\n\t\t<PublicationItem\r\n\t\t\tv-for=\"publication in publications\"\r\n\t\t\t:publication=\"publication\"\r\n\t\t\t:key=\"publication._id\"\r\n\t\t\t@deletePublication=\"deletePublication(publication._id)\"\r\n\t\t\t@editPublication=\"editPublication\"\r\n\t\t></PublicationItem>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\n\timport PublicationItem from \"./PublicationItem.vue\";\r\n\timport AddPublication from \"./AddPublication.vue\";\r\n\timport SearchPublications from \"./SearchPublications.vue\";\r\n\texport default {\r\n\t\tname: \"PublicationsList\",\r\n\t\tcomponents: {\r\n\t\t\tAddPublication,\r\n\t\t\tSearchPublications,\r\n\t\t\tPublicationItem,\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tpublications: {},\r\n\t\t\t\tpublishMode: false,\r\n\t\t\t\tresultats: 0,\r\n\t\t\t\tsearch: ''\r\n\t\t\t};\r\n\t\t},\r\n\t\tbeforeMount() {\r\n\t\t\tthis.getPublications();\r\n\t\t},\r\n\t\tmounted() {\r\n\t\t\tconst socket = new WebSocket(\"ws://localhost:5000\");\r\n\r\n\t\t\t// Connection opened\r\n\t\t\tsocket.addEventListener(\"open\", () => {\r\n\t\t\t\tconsole.log(\"connected to the ws server\");\r\n\t\t\t});\r\n\r\n\t\t\t// Listen for messages\r\n\t\t\tsocket.addEventListener(\"message\", () => {\r\n\t\t\t\tif (this.publishMode) {\r\n\t\t\t\t\tthis.getPublications();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.searchPublications(this.search);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tgetPublications() {\r\n\t\t\t\tfetch(\"http://localhost:5000/api/publications\")\r\n\t\t\t\t\t.then((res) => res.json())\r\n\t\t\t\t\t.then((publications) => {\r\n\t\t\t\t\t\tthis.publications = publications.data.reverse();\r\n\t\t\t\t\t\tthis.resultats = publications.data.length;\r\n\t\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\tlastSearch(search) {\r\n\t\t\t\tthis.search = search\r\n\t\t\t},\r\n\r\n\t\t\tsearchPublications(search) {\r\n\t\t\t\tfetch(\r\n\t\t\t\t\t`http://localhost:5000/api/publications/query?search=${search}`\r\n\t\t\t\t)\r\n\t\t\t\t\t.then((res) => res.json())\r\n\t\t\t\t\t.then((publications) => {\r\n\t\t\t\t\t\tif (!publications.success) {\r\n\t\t\t\t\t\t\tconsole.log(publications);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.publications = publications.data.reverse();\r\n\t\t\t\t\t\t\tthis.resultats = publications.data.length;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\taddPublication(postBody) {\r\n\t\t\t\tconst options = {\r\n\t\t\t\t\tmethod: \"POST\",\r\n\t\t\t\t\theaders: {\r\n\t\t\t\t\t\tAccept: \"application/json\",\r\n\t\t\t\t\t\t\"Content-Type\": \"application/json;charset=UTF-8\",\r\n\t\t\t\t\t},\r\n\t\t\t\t\tbody: JSON.stringify({\r\n\t\t\t\t\t\tcontent: postBody,\r\n\t\t\t\t\t}),\r\n\t\t\t\t};\r\n\t\t\t\tfetch(\"http://localhost:5000/api/publications\", options)\r\n\t\t\t\t\t.then((res) => res.json())\r\n\t\t\t\t\t.then((res) => {\r\n\t\t\t\t\t\tif (!res.success) {\r\n\t\t\t\t\t\t\tconsole.log(res.msg);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.getPublications();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch((error) => console.log(error));\r\n\t\t\t},\r\n\r\n\t\t\teditPublication(id, postBody) {\r\n\t\t\t\tconst options = {\r\n\t\t\t\t\tmethod: \"PATCH\",\r\n\t\t\t\t\theaders: {\r\n\t\t\t\t\t\tAccept: \"application/json\",\r\n\t\t\t\t\t\t\"Content-Type\": \"application/json;charset=UTF-8\",\r\n\t\t\t\t\t},\r\n\t\t\t\t\tbody: JSON.stringify({\r\n\t\t\t\t\t\tcontent: postBody,\r\n\t\t\t\t\t}),\r\n\t\t\t\t};\r\n\t\t\t\tfetch(`http://localhost:5000/api/publications/${id}`, options)\r\n\t\t\t\t\t.then((res) => res.json())\r\n\t\t\t\t\t.then((res) => {\r\n\t\t\t\t\t\tif (!res.success) {\r\n\t\t\t\t\t\t\tconsole.log(res.msg);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.getPublications();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch((error) => console.log(error));\r\n\t\t\t},\r\n\r\n\t\t\tdeletePublication(id) {\r\n\t\t\t\tconst options = {\r\n\t\t\t\t\tmethod: \"DELETE\",\r\n\t\t\t\t\theaders: {\r\n\t\t\t\t\t\tAccept: \"application/json\",\r\n\t\t\t\t\t\t\"Content-Type\": \"application/json;charset=UTF-8\",\r\n\t\t\t\t\t},\r\n\t\t\t\t};\r\n\t\t\t\tfetch(`http://localhost:5000/api/publications/${id}`, options)\r\n\t\t\t\t\t.then((res) => res.json())\r\n\t\t\t\t\t.then((res) => {\r\n\t\t\t\t\t\tif (!res.success) {\r\n\t\t\t\t\t\t\tconsole.log(res.msg);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.getPublications();\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch((error) => console.log(error));\r\n\t\t\t},\r\n\t\t},\r\n\t};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped></style>\r\n"]},"metadata":{},"sourceType":"module"}